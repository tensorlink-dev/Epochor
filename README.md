# Epochor Subnet

## Overview

Welcome to the Epochor Subnet! This subnet is designed for [TODO: Briefly describe the primary purpose and incentive of the Epochor subnet. What problem does it solve? What kind of value does it create?].

Miners contribute by [TODO: Briefly describe what miners do, e.g., "training time-series forecasting models and submitting their predictions" or "providing computational resources for X task"]. Validators evaluate these contributions and allocate rewards based on performance.

## Incentive Mechanism

[TODO: Describe the core incentive mechanism. How are miners rewarded? What are the key performance indicators (KPIs) that drive rewards? How is value distributed within the subnet? Be clear and concise.]

For example:
* Miners are rewarded based on the accuracy of their predictions on time-series data generated by validators.
* Rewards are proportional to the CRPS (Continuous Ranked Probability Score) their models achieve, potentially modified by stake, recency, and other factors.
* Validators are rewarded for successfully evaluating miners and maintaining consensus.

## How Scoring Works

Validators evaluate miner contributions through a multi-step process:

1.  **Data Generation (Validators):** Validators generate [TODO: e.g., "synthetic time-series datasets" or "real-world data challenges"] based on the current blockchain state (e.g., block number as a seed) to ensure unpredictability and fairness.
2.  **Task Execution (Miners):** Miners receive these tasks/datasets, apply their models (e.g., make predictions, perform computations), and submit their results/models to the network (e.g., via Hugging Face or directly).
3.  **Evaluation (Validators):**
    *   Validators fetch the miner submissions (e.g., models from Hugging Face, predictions from Axons).
    *   They run evaluations using metrics like [TODO: e.g., "CRPS, Mean Absolute Error, custom metrics specific to the subnet's domain"].
    *   Scores may be smoothed over time using an Exponential Moving Average (EMA) to provide more stable and reliable performance indicators.
4.  **Score Aggregation & Validation:**
    *   Raw scores from evaluations are processed. This might involve normalization, handling of outliers, or specific validation checks (e.g., ensuring predictions are in the correct format).
    *   The EMA scores (or other processed scores) are then used for reward calculation.
5.  **Weight Allocation:**
    *   The processed scores are converted into weights for on-chain reward distribution. This typically involves:
        *   A reward function (e.g., temperature-scaled softmax, linear scaling, rank-based decay) to map scores to relative weights.
        *   Optional features like a "first-place boost" or a minimum weight threshold.
    *   These weights determine the proportion of TAO emissions each miner receives for that evaluation period.

## How Validators Operate

Validators are crucial for the health and integrity of the Epochor subnet. Their responsibilities include:

1.  **Staying Synchronized:** Validators must keep their Bittensor components (wallet, subtensor, metagraph) synchronized with the network.
2.  **Generating Evaluation Tasks:** As described above, they generate the data or tasks for miners.
3.  **Querying Miners:** They identify active miners from the metagraph and query their Axons for responses or fetch their models from designated repositories (e.g., Hugging Face).
4.  **Evaluating Submissions:** They run the evaluation logic against miner submissions, calculating performance scores.
5.  **Tracking Scores:** Validators maintain a record of miner performance, often using an EMA to smooth scores over time and make them robust to short-term fluctuations.
6.  **Allocating Rewards:** Based on the EMA scores, validators calculate reward weights using the configured strategy (e.g., softmax with temperature scaling).
7.  **Setting Weights on Chain:** Validators submit these calculated weights to the Bittensor blockchain, influencing miner emissions.
8.  **Logging and Monitoring:** Validators log their operations and key metrics (e.g., to WandB) for transparency and operational monitoring.

**Running a Validator:**

*   Ensure you have `bittensor` installed and configured.
*   Install project-specific dependencies: `pip install -r requirements.txt`
*   Set up your environment variables (see `.env.example`), especially `WANDB_API_KEY` if using WandB.
*   Register your validator hotkey on the subnet.
*   Run the validator script: `python examples/run_validator.py --wallet.name <your_validator_wallet> --wallet.hotkey <your_validator_hotkey> --subtensor.network <network_name> --netuid <epochor_netuid>` (adjust parameters as needed).

## How Miners Operate

Miners are the primary contributors to the Epochor subnet. Their goal is to develop and run high-performing models or services that address the tasks defined by the subnet.

1.  **Model Development/Service Implementation:** Miners develop models (e.g., for time-series forecasting) or implement services according to the subnet's protocol.
2.  **Training (for model-based miners):**
    *   Miners train their models, potentially using offline datasets or techniques relevant to the subnet's domain.
    *   They may use local checkpointing (`epochor/trainer_utils.py`) to save and load models during training.
3.  **Serving the Model/Service:** Miners expose their model/service via a Bittensor Axon, allowing validators to query them.
4.  **Model Upload (for some subnet designs):**
    *   Miners may be required to upload their best models to a public repository like Hugging Face.
    *   Utilities in `epochor/mining.py` (e.g., `save_model`, `push_to_hf`) assist with this.
    *   Metadata about the uploaded model (e.g., HF repo ID, performance score at upload) is recorded, potentially using `epochor/metadata.py`.
5.  **Responding to Validator Queries:** Miners listen for requests from validators and provide responses (e.g., predictions, computation results) in a timely and accurate manner.
6.  **Optimization:** Miners continuously iterate on their models/services to improve performance and maximize their rewards.

**Running a Miner (Conceptual):**

*   Ensure you have `bittensor` installed and configured.
*   Install project-specific dependencies: `pip install -r requirements.txt`
*   Set up your environment variables (see `.env.example`), especially `HF_TOKEN` if pushing models to Hugging Face.
*   Develop your miner script (e.g., based on `template/miner.py` or a new `epochor/miner.py`).
*   Register your miner hotkey on the subnet.
*   Run your miner script: `python your_miner_script.py --wallet.name <your_miner_wallet> --wallet.hotkey <your_miner_hotkey> --subtensor.network <network_name> --netuid <epochor_netuid>` (adjust parameters as needed).

**Offline Training Example:**

Miners can train their models offline and then deploy the best version. The `examples/train_offline_miner.py` script provides a conceptual outline for this process.

## Project Structure Highlights

*   `epochor/`: Core logic for the Epochor subnet.
    *   `config.py`: Central configuration for parameters like EMA span, reward strategy, WandB settings.
    *   `validator.py`: Main validator implementation, including scoring, EMA tracking, and WandB logging.
    *   `rewards.py`: Functions for reward allocation strategies (softmax, linear, ranked decay).
    *   `ema_tracker.py`: Utility for Exponential Moving Average tracking of scores.
    *   `metrics_logger.py`: Wrapper for WandB logging.
    *   `metadata.py`: (Conceptual) For tracking model metadata on-chain and via Hugging Face.
    *   `miner.py`: (Placeholder) For main miner logic.
    *   `mining.py`: (Placeholder) Utilities for saving/loading models, pushing to Hugging Face.
    *   `trainer_utils.py`: (Placeholder) Utilities for local model training and checkpointing.
    *   `logging.py`: Basic logging configuration.
*   `examples/`: Example scripts for running validators and training miners.
*   `template/`: Bittensor neuron templates (often a starting point).
*   `tests/`: Unit and integration tests.
*   `.env.example`: Template for environment variables.
*   `requirements.txt`: Python dependencies.
*   `README.md`: This file.

## Getting Started

1.  **Clone the repository:**
    ```bash
    git clone <repository_url>
    cd <repository_name>
    ```
2.  **Install dependencies:**
    ```bash
    pip install -r requirements.txt
    ```
3.  **Set up your environment:**
    Copy `.env.example` to `.env` and fill in your API keys:
    ```bash
    cp .env.example .env
    # Edit .env with your WANDB_API_KEY and HF_TOKEN
    ```
4.  **Familiarize yourself with Bittensor:**
    If you are new to Bittensor, review the [Bittensor Documentation](https://docs.bittensor.com/).
5.  **Review the code:**
    Understand the components in the `epochor/` directory, especially `config.py`, `validator.py`, and `rewards.py`.
6.  **Run a Validator (see "How Validators Operate") or Develop a Miner (see "How Miners Operate").**

## Safety and Best Practices

*   **Secure Your Keys:** Protect your wallet hotkeys and coldkeys. Never share them or commit them to version control.
*   **Resource Management:** Be mindful of the computational resources your neuron consumes.
*   **Testing:** Test your miner or validator thoroughly in a local or testnet environment before deploying to the mainnet.
*   **Stay Updated:** Keep your Bittensor installation and subnet code updated to the latest versions.
*   **Monitor Your Neuron:** Regularly check the logs and performance of your neuron.
*   **Community:** Engage with the Bittensor and Epochor subnet community for support and updates.

---

This README provides a foundational understanding of the Epochor subnet. Specific details may evolve. Always refer to the latest code and official announcements for the most up-to-date information.
